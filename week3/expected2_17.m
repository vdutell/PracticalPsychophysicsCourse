function [expect_prob,prob,z_score] = expected2_17(crit, dprime, sigma, ddef)%Inputs: alpha specifies the point on ROC curve where d' is defined.%ddef=0 is at vertical intercept (z_hit = d' - crit/sigma)%ddef=1 is at horizontal intercept (z_hit = (d'-crit)/sigma)%ddef=.5 is at negative diagonal. This is the definition we often use.%The output is the expected probabilities.nstim=length(dprime);ncrit=length(crit);crit2=crit'*ones(1,nstim); %needed to make criteria into a two-dimensional matrixdprime2=ones(ncrit,1)*dprime;sigma2 =ones(ncrit,1)*sigma;%same herez_score=(1-ddef)*dprime2 + ddef*dprime2 ./sigma2 - crit2./sigma2;%hit rateprob=[ones(1,nstim);(1+erf(z_score/sqrt(2)))/2;zeros(1,nstim)];%erf to cumnormexpect_prob=-diff(prob);%responses in each category